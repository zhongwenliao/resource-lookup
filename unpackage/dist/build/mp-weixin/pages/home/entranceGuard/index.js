(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/entranceGuard/index"],{"0c2f":function(e,o,t){"use strict";var n=t("e1b8"),i=t.n(n);i.a},"4d66":function(e,o,t){"use strict";t.r(o);var n=t("88cc"),i=t("71c5");for(var r in i)"default"!==r&&function(e){t.d(o,e,(function(){return i[e]}))}(r);t("0c2f"),t("eeb6");var a,u=t("f0c5"),c=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"1d00ae4e",null,!1,n["a"],a);o["default"]=c.exports},"56ab":function(e,o,t){"use strict";(function(e){t("0fcb"),t("5c17");n(t("66fd"));var o=n(t("4d66"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(o.default)}).call(this,t("543d")["createPage"])},"71c5":function(e,o,t){"use strict";t.r(o);var n=t("9659"),i=t.n(n);for(var r in n)"default"!==r&&function(e){t.d(o,e,(function(){return n[e]}))}(r);o["default"]=i.a},"88cc":function(e,o,t){"use strict";t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return r})),t.d(o,"a",(function(){return n}));var n={uNavbar:function(){return t.e("uview-ui/components/u-navbar/u-navbar").then(t.bind(null,"4a31"))},uImage:function(){return t.e("uview-ui/components/u-image/u-image").then(t.bind(null,"b3a8"))},uToast:function(){return t.e("uview-ui/components/u-toast/u-toast").then(t.bind(null,"4663"))},uSearch:function(){return t.e("uview-ui/components/u-search/u-search").then(t.bind(null,"153b"))},uRow:function(){return t.e("uview-ui/components/u-row/u-row").then(t.bind(null,"a869"))},uCol:function(){return t.e("uview-ui/components/u-col/u-col").then(t.bind(null,"5563"))}},i=function(){var e=this,o=e.$createElement;e._self._c},r=[]},9659:function(e,o,t){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=i(t("ca65"));function i(e){return e&&e.__esModule?e:{default:e}}var r={data:function(){return{ContactProperty:[],screenData:[],listDataArr:[],listDataNew:[],keyword:"",show:!1,errorMsg:"",qrPath:"",mode:"canvas",qrCode:"",size:200,margin:10,backgroundColor:"#FFFFFF",foregroundColor:"#000000",errorCorrectLevel:n.default.errorCorrectLevel.H,typeNumber:-1,fileType:"png",title:e.getStorageSync("zoneInfo").name,isOpenBluetooth:!1}},onShow:function(){this.getDeviceList()},onLoad:function(){var o=this;this.openBluetoothAdapter().then((function(){o.getBluetoothAdapterState()})).finally((function(){console.log("蓝牙模块初始化完成"),e.onBluetoothAdapterStateChange((function(e){o.isOpenBluetooth=e.available,console.log("adapterState changed, now is",e)}))}))},methods:{bluebox:function(e){1!=e&&this.openBluetoothAdapter()},remoteOpenDoor:function(o){var t=this;if(console.log("远程开门"),"bluetooth"===o.type){var n=this.opendoor["remote-failed"]||"远程开门失败， ";this.$api("equipment.remoteDoor",{id:o.id,devSn:o.devSn}).then((function(i){200===i.code?e.showToast({title:"远程开门成功",duration:1e3,mask:!0}):"bluetooth"==o.type&&t.ifNeedBluetoothOpen(n,o)})).catch((function(e){"bluetooth"==o.type&&t.ifNeedBluetoothOpen(n,o)}))}else this.$api("equipment.appRemoteDoor",{roomNum:o.roomNum}).then((function(o){0===o.code?e.showToast({title:"开门成功",icon:"none"}):e.showToast({title:"开门失败,".concat(o.errmsg),icon:"none"})}))},ifNeedBluetoothOpen:function(o,t){var n=this,i=this;e.showModal({title:i.opendoor["bluetooth-tips"]||"蓝牙开门提示",content:o+i.opendoor["if-need-bluetooth"]||"是否需要进行蓝牙开门",confirmText:i.common["confirm"]||"确认",cancelText:i.common["cancel"]||"取消",success:function(o){o.confirm?n.bluetoothOpenDoor(t):e.hideLoading()}})},bluetoothOpenDoor:function(o){var t=this;e.showLoading({title:"开门中"}),setTimeout((function(){e.hideLoading()}),3e3);var n=this.$sdkUtil,i=e.getStorageSync("homeInfo"),r=o;console.log(111,o,i,i.isUploadSimByOpenDoor),n.bluetoothOpenDoor(o,(function(a){o.doorName,t.$refs;e.showToast({title:"开门成功",icon:"none"}),t.openDoorDeviceDoorName=o.doorName,e.navigateTo({url:"../../pages/open-door-success/open-door-success?doorName="+t.openDoorDeviceDoorName});var u=Date.parse(new Date),c=e.getStorageSync("openDoor").timestamp;setTimeout((function(){if(1==o.isSupportGetOpenDoorRecord)if(t.$sdkUtil.getRecentOpenDoorRecordFromDevice(o),c){var n=216e5;u-c>n&&(e.setStorageSync("openDoor",{timestamp:u}),setTimeout((function(){t.dumpEnergy_firmwareVersion(o)}),6e3))}else e.setStorageSync("openDoor",{timestamp:u}),setTimeout((function(){t.dumpEnergy_firmwareVersion(o)}),6e3);else t.dumpEnergy_firmwareVersion(o)}),4e3),setTimeout((function(){1==i.isUploadSimByOpenDoor&&(r.controlWay=1,r.eKey=o.appEkey,r.devType=o.deviceModelValue,console.log("获取sim卡信息"),n.getSimstatus(r,(function(e){if(0===e.errorCode){var n=e.data;t.uploadServer(n,o)}})))}),4e3)}))},temporaryPassword:function(o){e.navigateTo({url:"/sub-package1/pages/vis/vis?name=".concat(o.name,"&roomId=").concat(o.roomId,"&devSn=").concat(o.devSn)})},openBluetoothAdapter:function(){var o=this;return new Promise((function(t,n){e.openBluetoothAdapter({success:function(e){console.log("初始化蓝牙成功:"+e.errMsg),console.log(JSON.stringify(e)),t()},fail:function(t){console.log(t),console.log("初始化蓝牙失败，错误码："+(t.errCode||t.errMsg)),e.showModal({title:"提示！",content:"初始化蓝牙失败，请到设置里打开本机蓝牙！",showCancel:!1,confirmText:"确定",success:function(e){e.confirm}}),t.errCode,o.isOpenBluetooth=!1,n()}})}))},getBluetoothAdapterState:function(){var o=this;e.getBluetoothAdapterState({success:function(e){console.log(JSON.stringify(e)),o.isOpenBluetooth=!0},fail:function(e){o.isOpenBluetooth=!1,console.log("获取本机蓝牙适配器状态失败，错误码："+e.errCode),e.errCode}})},fuzzySearch:function(e){this.contactProperty=this.screenData,""!==e?(this.listDataNew=this.contactProperty.filter((function(o){var t=!1;for(var n in o)if(o.name&&o.name.toString().includes(e)){t=!0;break}if(t)return o})),this.contactProperty=this.listDataNew):this.contactProperty=this.listDataArr},getDeviceList:function(){var o=this,t={currPage:1};this.$api("equipment.equipmentList",t,!1).then((function(t){if(200==t.code){e.setStorageSync("deviceList",t.data),o.ContactProperty=t.data,o.screenData=JSON.parse(JSON.stringify(t.data)),o.listDataArr=JSON.parse(JSON.stringify(t.data));JSON.parse(JSON.stringify(o.ContactProperty));t.data===[]&&o.showToast()}}))},showToast:function(){this.$refs.uToast.show({title:"没有绑定设备"})},goPage:function(e){this.$Router.push({path:e.url,query:e})},DoorRecord:function(){this.$Router.push({path:"/pages/user/openDoorRecord"})},save:function(o){console.log("点击"),e.showLoading({mask:!0,title:"请稍后..."}),this.$refs[o].save({success:function(o){console.log(o),e.hideLoading(),e.showToast({icon:"none",title:o.msg})},fail:function(o){e.hideLoading(),e.showToast({icon:"none",title:JSON.stringify(o)})}})}}};o.default=r}).call(this,t("543d")["default"])},c64b:function(e,o,t){},e1b8:function(e,o,t){},eeb6:function(e,o,t){"use strict";var n=t("c64b"),i=t.n(n);i.a}},[["56ab","common/runtime","common/vendor"]]]);