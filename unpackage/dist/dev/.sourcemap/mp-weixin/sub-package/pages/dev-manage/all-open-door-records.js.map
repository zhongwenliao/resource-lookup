{"version":3,"sources":["uni-app:///main.js","webpack:///D:/Project/resource-lookup/sub-package/pages/dev-manage/all-open-door-records.vue?6f0b","webpack:///D:/Project/resource-lookup/sub-package/pages/dev-manage/all-open-door-records.vue?9f3f","webpack:///D:/Project/resource-lookup/sub-package/pages/dev-manage/all-open-door-records.vue?67af","webpack:///D:/Project/resource-lookup/sub-package/pages/dev-manage/all-open-door-records.vue?7472","uni-app:///sub-package/pages/dev-manage/all-open-door-records.vue","webpack:///D:/Project/resource-lookup/sub-package/pages/dev-manage/all-open-door-records.vue?f12b"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniBasePage","uniEmptyPage","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","devObj","uploadOpenDoorRecordsEvent","data","allRecords","eventType","methods","readAllRecords","deviceOpenDoorRecordsList","bluetoothEventType","bluetoothEventResult","saveRecords","computed","common","records","onLoad","openDoorEvent","onShow"],"mappings":"2KAAA,MAE4D,MAC5D,aACA,YAFAA,GAAGC,kCAAoCC,EAGvCC,EAAWC,a,gECLX,oIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,yDACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,YAAa,WACX,OAAO,sEAITC,aAAc,WACZ,OAAO,0EAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCCtCvB,yHAA0qB,eAAG,G,mGCuB7qB,SACAC,KAEAC,GACA,SACA,SACA,QACA,SACA,SACA,SACA,QACA,UACA,SACA,SACA,SACA,SACA,QACA,UACA,EACA,CACAC,gBACA,OACAC,cACAC,iBAGAC,SAMAC,2BAAA,WAEA,mBAMA,yDAEA,aACA,oCAGAC,mBAMA,OACA,KACA,WACA,aACA,KACA,KACA,WACA,KACA,cAIA,SAAAC,SAAAC,WACA,GACA,eACA,2BACA,gFACA,YACA,cACA,yCAGA,wBAIA,iCACA,2CAQAC,uBAAA,WACAtB,6BAEA,wCACAc,uBACA,kBACA,cACA,8BAgBAS,UACAC,kBACA,0BAEAC,mBACA,4BAGAC,mBACA,8CACAd,uBACAe,GACA,wCACA,wCACA,uCACA,4CACA,oCACA,0CACA,oCACA,gDAEA,wBAEAC,qBACA,a,iCC7JA,yHAA68B,eAAG,G","file":"sub-package/pages/dev-manage/all-open-door-records.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;;import '@dcloudio/vue-cli-plugin-uni/packages/uni-push/dist/uni-push.es.js';\nimport Vue from 'vue'\nimport Page from './sub-package/pages/dev-manage/all-open-door-records.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./all-open-door-records.vue?vue&type=template&id=71fe6db7&\"\nvar renderjs\nimport script from \"./all-open-door-records.vue?vue&type=script&lang=js&\"\nexport * from \"./all-open-door-records.vue?vue&type=script&lang=js&\"\nimport style0 from \"./all-open-door-records.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"sub-package/pages/dev-manage/all-open-door-records.vue\"\nexport default component.exports","export * from \"-!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./all-open-door-records.vue?vue&type=template&id=71fe6db7&\"","var components\ntry {\n  components = {\n    uniBasePage: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-base-page/uni-base-page\" */ \"@/components/uni-base-page/uni-base-page.vue\"\n      )\n    },\n    uniEmptyPage: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-empty-page/uni-empty-page\" */ \"@/components/uni-empty-page/uni-empty-page.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./all-open-door-records.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./all-open-door-records.vue?vue&type=script&lang=js&\"","<template>\r\n\t<uni-base-page class=\"uni-base-page\">\r\n\t\t<view class=\"list-view-container\" v-if=\"allRecords.length > 0\">\r\n\t\t\t<ul class=\"list-ul-container\">\r\n\t\t\t\t<li class=\"li-border-bottom\">\r\n\t\t\t\t\t<view class=\"list-item clear\">\r\n\t\t\t\t\t\t<view class=\"left-name fl\">{{ \"所有记录\" }} : {{ allRecords.length }}</view>\r\n\t\t\t\t\t\t<view class=\"save-record fr\" style=\"color: #088b68;\" v-if=\"allRecords.length > 0\" @click=\"saveRecords\">上传开门记录</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li class=\"li-border-bottom\" v-for=\"record in allRecords\">\r\n\t\t\t\t\t<text>{{ record.eventName }}</text>\r\n\t\t\t\t\t<text>{{ record.number }}</text>\r\n\t\t\t\t\t<text>{{ record.eventTime }}</text>\r\n\t\t\t\t\t<text>{{ record.eventResult }}</text>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</view>\r\n\t\t<uni-empty-page v-else></uni-empty-page>\r\n\t</uni-base-page>\r\n</template>\r\n\r\n<script>\r\nlet openDoorEvent = {}, \r\n\tdevObj = {},\r\n\t// 上传到服务器的开门记录的事件类型（key: eventType + \"-\" + result，value: eventTypeValue）\r\n\tuploadOpenDoorRecordsEvent = {\r\n\t\t\"1-0\": 19,       // 手机蓝牙开门成功\r\n\t\t\"1-1\": 79,       // 手机蓝牙开门失败\r\n\t\t\"2-0\": 0,       // 刷卡开门成功\r\n\t\t\"2-1\": 47,     \t// 刷卡开门失败\r\n\t\t\"3-0\": 20,\t\t// 临时密码开门成功\r\n\t\t\"3-1\": 77,\t\t// 临时密码开门失败\r\n\t\t\"4-0\": 8,\t\t// 远程开门开门成功\r\n\t\t\"5-0\": 122,\t\t// 触摸开门成功\r\n\t\t\"6-0\": 24,\t\t// 指纹开门成功\r\n\t\t\"6-1\": 65,\t\t// 指纹开门失败\r\n\t\t\"7-0\": 23,\t\t// 二维码开门成功\r\n\t\t\"7-1\": 74,\t\t// 二维码开门失败\r\n\t\t\"8-0\": 4,\t\t// 固定密码开门成功\r\n\t\t\"8-1\": 50\t\t// 固定密码开门失败\r\n\t};\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tallRecords: [],\r\n\t\t\teventType: null\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 通过蓝牙获取设备返回的开门记录类型：1:蓝牙开门, 2:刷卡开门, 3: 密码开门, 4:远程开门, 5:触摸开门,6:指纹开门, 7:二维码，8:固定密码\r\n\t\t * 开门记录结果openDoorResult：0：成功，1：失败\r\n\t\t */\r\n\t\t//读取所有开门记录\r\n\t\treadAllRecords(devObj) {\r\n\t\t\t// 初始化用于显示在界面和上传服务器的记录列表(this.allRecords)\r\n\t\t\tthis.allRecords = [];\r\n\t\t\t\r\n\t\t\t// 1. 通过蓝牙本地插件(DoorMaster-Bluetooth-Plugin)获取当前设备的开门记录(该记录不包含手机蓝牙开门，因为当\r\n\t\t\t// 进行一次手机蓝牙开门操作后，蓝牙本地插件(DoorMaster-Bluetooth-Plugin)内部会自动上传该记录到服务器，前提是你有调用该插件内部提供的\r\n\t\t\t// 登录接口)\r\n\t\t\t// 2. 进一步加工后，从而赋值给用于显示在界面和上传服务器的记录列表(this.allRecords)\r\n\t\t\tthis.$sdkUtil.getOpenDoorRecordFromDevice(devObj, (result) => {\r\n\t\t\t\t// 通过蓝牙本地插件(DoorMaster-Bluetooth-Plugin)获取当前设备的开门记录\r\n\t\t\t\tlet deviceOpenDoorRecordsList = result.data;\r\n\t\t\t\tthis.$showLog(\"通过蓝牙本地插件获取当前设备的开门记录\", deviceOpenDoorRecordsList);\r\n\t\t\t\t\r\n\t\t\t\t// 遍历从蓝牙本地插件(DoorMaster-Bluetooth-Plugin)获取到的设备开门记录，从而组装成另一个记录列表(this.allRecords)，用来显示在界面和上传到服务器这两个方面\r\n\t\t\t\tdeviceOpenDoorRecordsList.map((item) => {\r\n\t\t\t\t\t// 由于从蓝牙本地插件(DoorMaster-Bluetooth-Plugin)获取到的设备开门记录中的每一条记录都含有cardno字段和password字段，但实际上我们最多只使用其中一个，\r\n\t\t\t\t\t// 如蓝牙开门(eventReturnNumber的1属性)不需要cardno和password，所以它对应的值是空字符串。刷卡开门(eventReturnNumber的2属性)只需要用到cardno，\r\n\t\t\t\t\t// 所以它对应的值是cardno的值，密码开门(eventReturnNumber的3属性)只需要用到password，所以它对应的值是password的值，往后以此类推。eventReturnNumber的\r\n\t\t\t\t\t// 作用一个是当该条记录是刷卡开门时，界面上显示卡号，当该条记录是密码开门时，界面上显示密码等。另一个是上传到服务器的开门记录中包含number字段，该字段的取值是刷卡开门和\r\n\t\t\t\t\t// 指纹开门(指纹id的值放在cardno)的cardno字段以及密码开门和固定密码开门的password字段。\r\n\t\t\t\t\tlet eventReturnNumber = {\r\n\t\t\t\t\t\t1: \"\",   // 蓝牙开门\r\n\t\t\t\t\t\t2: item.cardno,  // 刷卡开门\r\n\t\t\t\t\t\t3: item.password,  // 密码开门\r\n\t\t\t\t\t\t4: \"\",  // 远程开门\r\n\t\t\t\t\t\t5: \"\",  // 触摸开门\r\n\t\t\t\t\t\t6: item.cardno,  // 指纹开门\r\n\t\t\t\t\t\t7: \"\",  // 二维码开门\r\n\t\t\t\t\t\t8: item.password  // 固定密码开门\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 组装成另一个记录列表(this.allRecords)，用来显示在界面和上传到服务器这两个方面\r\n\t\t\t\t\tlet recordTime = item.date, bluetoothEventType = item.type, bluetoothEventResult = item.result;\r\n\t\t\t\t\tlet recordObj = {\r\n\t\t\t\t\t\t\"eventName\": openDoorEvent[bluetoothEventType],\r\n\t\t\t\t\t\t\"eventTime\": this.$formatTime(recordTime),\r\n\t\t\t\t\t\t\"eventResult\": bluetoothEventResult == 0 ? this.common[\"open-success\"] || \"开门成功\" : this.common[\"open-fail\"] || \"开门失败\",\r\n\t\t\t\t\t\t\"number\": eventReturnNumber[bluetoothEventType],\r\n\t\t\t\t\t\t\"devSn\": devObj.devSn,\r\n\t\t\t\t\t\t\"eventType\": uploadOpenDoorRecordsEvent[`${bluetoothEventType}-${bluetoothEventResult}`]\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// console.log(\"结果\",recordObj.eventResult)\r\n\t\t\t\t\tthis.allRecords.push(recordObj);\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 给开门记录做排序\r\n\t\t\t\tthis.allRecords.sort((a, b) => {\r\n\t\t\t\t\treturn b.eventTime > a.eventTime ? 1 : -1;\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// this.$showLog(\"蓝牙读取所有开门记录\", this.allRecords);\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t// 将从蓝牙本地插件(DoorMaster-Bluetooth-Plugin)获取到的存储在蓝牙门禁设备里的开门记录保存(上传)到服务器\r\n\t\tsaveRecords() {\r\n\t\t\tconsole.log(this.allRecords);\r\n\t\t\t\r\n\t\t\tthis.$api('equipment.addDevOpenRecord', {\r\n\t\t\t\tdata: this.allRecords,\r\n\t\t\t}).then(res => {\r\n\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\tthis.$showToast(\"添加开门记录成功\");\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// this.$req.request({\r\n\t\t\t// \turl: \"/accEventlog/app/add?accessToken=\" + this.$getUserInfo().accessToken,\r\n\t\t\t// \tmethod: \"POST\",\r\n\t\t\t// \theader: {\r\n\t\t\t// \t\t\"content-type\": \"application/json\"\r\n\t\t\t// \t},\r\n\t\t\t\t\r\n\t\t\t// \tsuccess: res => {\r\n\t\t\t\t\t\r\n\t\t\t// \t}\r\n\t\t\t// });\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcommon() {\r\n\t\t\treturn this.$t(\"common\");\r\n\t\t},\r\n\t\trecords() {\r\n\t\t\treturn this.$t(\"records\");\r\n\t\t}\r\n\t},\r\n\tonLoad(options) {\r\n\t\tthis.$setTitle(this.records[\"title\"] || \"开门记录\");\r\n\t\tdevObj = JSON.parse(options.devObj);\r\n\t\topenDoorEvent = {\r\n\t\t\t1: this.records[\"bluetooth_key\"] || \"蓝牙开门\",\r\n\t\t\t2: this.records[\"slot_card_key\"] || \"刷卡开门\",\r\n\t\t\t3: this.records[\"password_key\"] || \"密码开门\",\r\n\t\t\t4: this.records[\"long_distance_key\"] || \"远程开门\",\r\n\t\t\t5: this.records[\"touch_key\"] || \"触摸开门\",\r\n\t\t\t6: this.records[\"fingerprint_key\"] || \"指纹开门\",\r\n\t\t\t7: this.records[\"code_key\"] || \"二维码开门\",\r\n\t\t\t8: this.records[\"fixed_password_key\"] || \"固定密码开门\"\r\n\t\t};\r\n\t\tthis.readAllRecords(devObj);\r\n\t},\r\n\tonShow() {}\r\n};\r\n</script>\r\n\r\n<style>\r\n.li-border-bottom {\r\n\tpadding: 10upx;\r\n\tborder-bottom: 1upx solid #d3d3d3;\r\n}\r\n\r\n.li-border-bottom text {\r\n\tpadding: 0 10upx;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./all-open-door-records.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../常用软件/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./all-open-door-records.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}