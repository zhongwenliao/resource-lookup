{"version":3,"sources":["webpack:///src/components/Resources/Panorama.vue","webpack:///./src/components/Resources/Panorama.vue?1b1f","webpack:///./src/components/Resources/Panorama.vue"],"names":["Panorama","components","name","data","xmlDomData","krpanoDom","beforeCreate","created","this","init","beforeMount","window","initKrpanoReady","handleClickHotSpots","mounted","embedpano","xml","target","html5","mobilescale","passQueryParameters","onready","methods","handleXMLElementDom","title","XMLdata","targetName","createLabel","labelAttribute","xmlDoc","loadXMLString","createNode","createElement","map","i","key","Object","hasOwnProperty","call","val","setAttribute","sceneList","getElementsByTagName","element","attributes","nodeValue","appendChild","console","log","error","txt","DOMParser","parseFromString","ActiveXObject","async","loadXML","document","getElementById","deviceType","targetScene","Resources_Panorama","render","_h","$createElement","_self","_c","attrs","id","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"qGAKA,IAAAA,GACAC,cACAC,KAAA,WACAC,KAHA,WAIA,OACAC,WAAA,woGAoBAC,UAAA,OAGAC,aA5BA,aA6BAC,QA7BA,WA8BAC,KAAAC,QAEAC,YAhCA,WAiCAC,OAAA,gBAAAH,KAAAI,gBACAD,OAAA,oBAAAH,KAAAK,qBAEAC,QApCA,WAsCAH,OAAAI,WACAC,IAAA,EACAC,OAAA,OACAC,MAAA,OACAC,YAAA,EACAC,oBAAA,yBACAC,QAAAV,OAAAC,mBAGAU,SACAb,KADA,WAEAD,KAAAe,oBAAAf,KAAAJ,WAAA,2BAAAF,KAAA,QAAAsB,MAAA,YAEAD,oBAJA,SAIAE,EAAAC,EAAAC,EAAAC,GACA,IACA,IAAAC,EAAArB,KAAAsB,cAAAL,EAAA,KACAM,EAAAF,EAAAG,cAAAL,GACAC,EAAAK,IAAA,SAAAC,GACA,QAAAC,KAAAD,EACA,GAAAE,OAAAC,eAAAC,KAAAJ,EAAAC,GAAA,CACA,IAAAI,EAAAL,EAAAC,GACAJ,EAAAS,aAAAL,EAAAI,MAIA,IAAAE,EAAAZ,EAAAa,qBAAA,SACA,QAAAP,KAAAM,EACA,GAAAL,OAAAC,eAAAC,KAAAG,EAAAN,GAAA,CACA,IAAAQ,EAAAF,EAAAN,GACAQ,EAAAC,WAAA1C,KAAA2C,YAAAnB,GACAiB,EAAAG,YAAAf,GAIAgB,QAAAC,IAAAnB,GACA,MAAAoB,GACAF,QAAAC,IAAAC,KAIAnB,cA/BA,SA+BAoB,GACA,IAAArB,OAAA,EACAlB,OAAAwC,UAEAtB,GADA,IAAAsB,WACAC,gBAAAF,EAAA,cAEArB,EAAA,IAAAwB,cAAA,qBACAC,OAAA,EACAzB,EAAA0B,QAAAL,IAEA,OAAArB,GAGAjB,gBA5CA,WA6CAJ,KAAAH,UAAAmD,SAAAC,eAAA,mBACAjD,KAAAH,UAAAiC,KAAA,WAAA9B,KAAAJ,WAAA,MAEAS,oBAhDA,SAgDA6C,EAAAC,GACAD,EACAX,QAAAC,IAAA,WAGAxC,KAAAH,UAAAiC,KAAA,sBAAAqB,EAAA,QCtGeC,GADEC,OAFjB,WAA0B,IAAaC,EAAbtD,KAAauD,eAAkD,OAA/DvD,KAAuCwD,MAAAC,IAAAH,GAAwB,OAAiBI,OAAOC,GAAA,WAEhGC,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACEvE,EACA4D,GATF,EAVA,SAAAY,GACEF,EAAQ,SAaV,kBAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/3.e36a63816ff89421c39c.js","sourcesContent":["<template>\n  <div id=\"pano\"></div>\n</template>\n\n<script>\nexport default {\n  components: {},\n  name: 'Panorama',\n  data() {\n    return {\n      xmlDomData: `<krpano version=\"1.20.7\" onstart=\"loadscene(scene_hongqi);\">\n<scene name=\"scene_hongqi\">\n<preview url=\"http://124.71.75.230/hongqi/icon/01.jpg\" type=\"SPHERE\"/>\n<view hlookat=\"0\" vlookat=\"0\" hlookatmin=\"-180\" hlookatmax=\"180\" vlookatmin=\"-90\" vlookatmax=\"90\" fovtype=\"MFOV\" fovmin=\"60\" fovmax=\"150\" fov=\"90\"/>\n<hotspot name=\"spot_scene\" url=\"http://124.71.75.230/hongqi/icon/new_spotd1_gif.png\" ath=\"0\" atv=\"0\" scale=\"0.6\" zoom=\"true\" device_type=\"\" device_title=\"\" target_scene=\"scene_hongqi_1\" onloaded=\"hotspot_do_animation();hotspot_show_title();\" onclick=\"hotspot_click();\"/>\n<hotspot name=\"spot_device\" url=\"http://124.71.75.230/hongqi/icon/new_spotd12_gif.png\" ath=\"90\" atv=\"0\" scale=\"0.6\" zoom=\"true\" device_type=\"dahua\" device_title=\"大华设备\" target_scene=\"\" onloaded=\"hotspot_do_animation();hotspot_show_title();\" onclick=\"hotspot_click();\"/>\n</scene>\n<scene name=\"scene_hongqi_1\">\n<preview url=\"http://124.71.75.230/hongqi/icon/01.jpg\" type=\"SPHERE\"/>\n<view hlookat=\"0\" vlookat=\"0\" hlookatmin=\"-180\" hlookatmax=\"180\" vlookatmin=\"-90\" vlookatmax=\"90\" fovtype=\"MFOV\" fovmin=\"60\" fovmax=\"150\" fov=\"90\"/>\n</scene>\n<!--  热点增加动画  -->\n<action name=\"hotspot_do_animation\" scope=\"local\"> calc(local.xframes, (caller.imagewidth /128) BOR 0); calc(local.frames, xframes * ((caller.imageheight / 128) BOR 0)); def(local.frame, integer, 0); calc(caller.crop, '0|0|' + 128 + '|' + 128); setinterval(calc('crop_anim_' + caller.name), 0.03, if(caller.loaded, inc(frame); if(frame GE frames, if(caller.onlastframe !== null, callwith(caller, onlastframe() ) ); set(frame,0); ); mod(xpos, frame, xframes); div(ypos, frame, xframes); Math.floor(ypos); mul(xpos, 128); mul(ypos, 128); calc(caller.crop, xpos + '|' + ypos + '|' + 128 + '|' + 128); , clearinterval(calc('crop_anim_' + caller.name)); ); ,10); </action>\n<!--  热点切换场景  -->\n<action name=\"hotspot_jump_scene\" scope=\"local\" args=\"jump_scene\"> loadscene(get(jump_scene),null,MERGE,ZOOMBLEND(2.0, 2.0, easeInOutSine)); </action>\n<!--  热点显示标题，device_title 字段  -->\n<action name=\"hotspot_show_title\"> txtadd(tooltipname, 'tooltip_', get(name)); addplugin(get(tooltipname)); txtadd(plugin[get(tooltipname)].parent, 'hotspot[',get(name),']'); set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf'); set(plugin[get(tooltipname)].align,top); set(plugin[get(tooltipname)].edge,bottom); set(plugin[get(tooltipname)].x,0); set(plugin[get(tooltipname)].y,0); set(plugin[get(tooltipname)].autowidth,true); set(plugin[get(tooltipname)].autoheight,true); set(plugin[get(tooltipname)].background,false); set(plugin[get(tooltipname)].border,false); set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family: PingFangSC-Medium,PingFang SC; font-weight:bold; font-size:16px;'); set(plugin[get(tooltipname)].textshadow,1); set(plugin[get(tooltipname)].textshadowrange,6.0); set(plugin[get(tooltipname)].textshadowangle,90); copy(plugin[get(tooltipname)].html,hotspot[get(name)].device_title); set(plugin[get(tooltipname)].enabled,false); </action>\n<!--  调用外部的js方法  -->\n<action name=\"hotspot_click\"> js(handleClickHotSpots(get(device_type),get(target_scene))); </action>\n</krpano>`,\n      krpanoDom: null\n    }\n  },\n  beforeCreate() {},\n  created() {\n    this.init()\n  },\n  beforeMount() {\n    window['initKrpanoReady'] = this.initKrpanoReady\n    window['handleClickHotSpots'] = this.handleClickHotSpots\n  },\n  mounted() {\n    // eslint-disable-next-line standard/object-curly-even-spacing\n    window.embedpano({\n      xml: 0,\n      target: 'pano',\n      html5: 'only',\n      mobilescale: 1.0,\n      passQueryParameters: 'startscene,startlookat',\n      onready: window.initKrpanoReady\n    })\n  },\n  methods: {\n    init() {\n      this.handleXMLElementDom(this.xmlDomData, 'scene_hongqi', 'hotspot', [{ name: '10086', title: '设备传感器' }])\n    },\n    handleXMLElementDom(XMLdata, targetName, createLabel, labelAttribute) {\n      try {\n        let xmlDoc = this.loadXMLString(`${XMLdata})`)\n        let createNode = xmlDoc.createElement(createLabel)\n        labelAttribute.map(i => {\n          for (const key in i) {\n            if (Object.hasOwnProperty.call(i, key)) {\n              const val = i[key]\n              createNode.setAttribute(key, val)\n            }\n          }\n        })\n        let sceneList = xmlDoc.getElementsByTagName('scene')\n        for (const key in sceneList) {\n          if (Object.hasOwnProperty.call(sceneList, key)) {\n            const element = sceneList[key]\n            if (element.attributes.name.nodeValue === targetName) {\n              element.appendChild(createNode)\n            }\n          }\n        }\n        console.log(xmlDoc)\n      } catch (error) {\n        console.log(error)\n      }\n    },\n    // 操作xml\n    loadXMLString(txt) {\n      let xmlDoc\n      if (window.DOMParser) {\n        let parser = new DOMParser()\n        xmlDoc = parser.parseFromString(txt, 'text/xml')\n      } else {\n        xmlDoc = new ActiveXObject('Microsoft.XMLDOM')\n        xmlDoc.async = false\n        xmlDoc.loadXML(txt)\n      }\n      return xmlDoc\n    },\n    // krpano对象初始化完成后调用\n    initKrpanoReady() {\n      this.krpanoDom = document.getElementById('krpanoSWFObject')\n      this.krpanoDom.call(`loadxml(${this.xmlDomData})`)\n    },\n    handleClickHotSpots(deviceType, targetScene) {\n      if (deviceType) {\n        console.log('这里做弹框操作')\n      } else {\n        // 这里执行场景切换逻辑\n        this.krpanoDom.call(`hotspot_jump_scene(${targetScene})`)\n      }\n    }\n  }\n}\n</script>\n\n<style stylt=\"less\" scoped>\n#pano {\n  width: 100%;\n  height: 85vh;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Resources/Panorama.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"pano\"}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-57a73bb0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Resources/Panorama.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-57a73bb0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Panorama.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Panorama.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Panorama.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-57a73bb0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Panorama.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-57a73bb0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Resources/Panorama.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}